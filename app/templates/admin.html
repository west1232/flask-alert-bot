<!DOCTYPE html>
<html>
<head>
    <title>Admin</title>
</head>
<body>
    {% if not session.logged_in %}
    <h2>ログイン</h2>
    {% if error %}<p style="color:red">{{ error }}</p>{% endif %}
    <form method="POST">
        <input type="password" name="password" placeholder="Password"/>
        <button type="submit">ログイン</button>
    </form>
    {% else %}
    <h2>管理画面 - ルールON/OFF</h2>
    <table border="1" cellpadding="5">
        <tr>
            <th>Symbol</th>
            <th>Timeframe</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
        {% for symbol, tfs in rules.items() %}
            {% for tf, status in tfs.items() %}
            <tr>
                <td>{{ symbol }}</td>
                <td>{{ tf }}</td>
                <td>{{ "ON" if status else "OFF" }}</td>
                <td>
                    <form method="POST" style="display:inline;">
                        <input type="hidden" name="symbol" value="{{ symbol }}">
                        <input type="hidden" name="timeframe" value="{{ tf }}">
                        <button type="submit">Toggle</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        {% endfor %}
    </table>
    {% endif %}
</body>
</html>
